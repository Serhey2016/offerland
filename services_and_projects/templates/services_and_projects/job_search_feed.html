{% load static %}

{% comment %}
–≠—Ç–æ—Ç —à–∞–±–ª–æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –æ–±—ä–µ–∫—Ç–æ–º JobSearch
{% endcomment %}

{% if job_search %}
<div class="social_feed2" data-post-id="{{ job_search.id }}" data-post-type="job_search">
    <div class="post_info_block">
        <div class="post_info_dates">
            <div class="post_info_start_date_column">
                <span class="post_info_start_date">start date:</span>
                <span class="post_start_date" id="post_start_date_{{ job_search.id }}">
                    {% if job_search.start_date %}
                        {{ job_search.start_date|date:'d.m.Y' }}
                    {% else %}
                        Not started
                    {% endif %}
                </span>
            </div>
            <div class="post_info_dates_type_of_view">Job Search</div>
            <div class="post_info_end_date_column">
                <span class="post_info_end_date">last update:</span>
                <span class="post_end_date">{{ job_search.last_update|date:'d.m.Y' }}</span>
            </div>
        </div>
        <div class="jsf_actions_container">
            <!-- Heart icon for favorites -->
            <span class="sftsts1_favorites_icon favorite-unchecked" id="favorites_icon_{{ job_search.id }}" data-favorite="false">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                </svg>
            </span>
            <div class="jsf_dropdown_menu" id="jsf_dropdown_menu_{{ job_search.id }}">
            <div class="jsf_dropdown_content" id="jsf_dropdown_content_{{ job_search.id }}" style="display: none;">
                <div class="jsf_dropdown_item start" data-action="start" data-id="{{ job_search.id }}">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M8 5v14l11-7z"/>
                    </svg>
                    Start
                </div>
                <div class="jsf_dropdown_item edit" data-action="edit" data-id="{{ job_search.id }}">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                    </svg>
                    Edit
                </div>
                <div class="jsf_dropdown_item publish" data-action="publish" data-id="{{ job_search.id }}">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                    </svg>
                    Publish
                </div>
                <div class="jsf_dropdown_item archive" data-action="archive" data-id="{{ job_search.id }}">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M20.54 5.23l-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.16.55L3.46 5.23C3.17 5.57 3 6.02 3 6.5V19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.48-.17-.93-.46-1.27zM12 17.5l-4-4h2.5V12h3v1.5H16l-4 4z"/>
                    </svg>
                    Archive
                </div>
            </div>
        </div>
        </div>
    </div>

    <div class="post_info_title_row">
        <div class="post_info_project_or_task_title_column">
            <span class="post_info_project_or_task_title_text">{{ job_search.title }}</span>
           
        </div>
        <div class="post_info_icons_scroll">
            <div id="note_button_007_post_info_icon_notes_{{ job_search.id }}" class="post_info_icon notes-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="76.191" height="50.794" viewBox="0 0 76.191 50.794">
                    <path id="notes_24dp_E3E3E3_FILL0_wght400_GRAD0_opsz24"
                        d="M120-669.206v-8.466h50.794v8.466Zm0-21.164v-8.466h76.191v8.466Zm0-21.164V-720h76.191v8.466Z"
                        transform="translate(-120 720)" fill="#dfb30b" />
                </svg>
            </div>

        </div>
        <div class="social_feed_button_container_row">
            <span class="social_feed_button_container_button">
                <a href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="65"
                        height="65" viewBox="0 0 84 84">

                        <g id="Group_222" data-name="Group 222" transform="translate(-641 -581)">

                            <text id="_" data-name="üí°" transform="translate(650.437 637)" fill="#6f6d6d" font-size="46"
                                font-family="SegoeUIEmoji, Segoe UI Emoji">
                                <tspan x="0" y="0">üí°</tspan>
                            </text>
                        </g>
                    </svg>
                </a>

            </span>
            <span class="social_feed_button_container_button2" id="social_feed_button_container_button2_id">
                <a href="#"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                        width="65" height="65" viewBox="0 0 85 86">
                        <defs>
                            <filter id="Ellipse_13" x="0" y="1" width="85" height="85" filterUnits="userSpaceOnUse">
                                <feOffset dy="3" input="SourceAlpha" />
                                <feGaussianBlur stdDeviation="3" result="blur" />
                                <feFlood flood-opacity="0.161" />
                                <feComposite operator="in" in2="blur" />
                                <feComposite in="SourceGraphic" />
                            </filter>
                            <filter id="Ellipse_13-2" x="0" y="1" width="85" height="85" filterUnits="userSpaceOnUse">
                                <feOffset dy="3" input="SourceAlpha" />
                                <feGaussianBlur stdDeviation="3" result="blur-2" />
                                <feFlood flood-opacity="0.161" result="color" />
                                <feComposite operator="out" in="SourceGraphic" in2="blur-2" />
                                <feComposite operator="in" in="color" />
                                <feComposite operator="in" in2="SourceGraphic" />
                            </filter>
                        </defs>
                        <g id="Group_232" data-name="Group 232" transform="translate(-634.761 -1613.451)">
                            <g data-type="innerShadowGroup">
                                <g transform="matrix(1, 0, 0, 1, 634.76, 1613.45)" filter="url(#Ellipse_13)">
                                    <circle id="Ellipse_13-3" data-name="Ellipse 13" cx="33.5" cy="33.5" r="33.5"
                                        transform="translate(9 7)" fill="#fff" />
                                </g>
                                <g transform="matrix(1, 0, 0, 1, 634.76, 1613.45)" filter="url(#Ellipse_13-2)">
                                    <circle id="Ellipse_13-4" data-name="Ellipse 13" cx="33.5" cy="33.5" r="33.5"
                                        transform="translate(9 7)" fill="#fff" />
                                </g>
                            </g>
                            <text id="_" data-name="+" transform="translate(677.261 1680.451)" fill="#fff478"
                                stroke="#fcd53f" stroke-width="2" font-size="74" font-family="Comfortaa-Bold, Comfortaa"
                                font-weight="700">
                                <tspan x="-20.239" y="0">+</tspan>
                            </text>
                        </g>
                    </svg>
                </a>
            </span>
        </div>
    </div>


    <div class="social_feed_hide_icon2" id="jobFeedHideIcon_{{ job_search.id }}">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="35" height="35"
            viewBox="0 0 86.55 86.55">
            <defs>
                <filter id="Ellipse_16" x="0" y="0" width="86.55" height="86.55" filterUnits="userSpaceOnUse">
                    <feOffset dy="3" input="SourceAlpha" />
                    <feGaussianBlur stdDeviation="3" result="blur" />
                    <feFlood flood-opacity="0.161" />
                    <feComposite operator="in" in2="blur" />
                </filter>
                <filter id="Ellipse_16-2" x="0" y="0" width="86.55" height="86.55" filterUnits="userSpaceOnUse">
                    <feOffset dy="3" input="SourceAlpha" />
                    <feGaussianBlur stdDeviation="3" result="blur-2" />
                    <feFlood flood-opacity="0.161" result="color" />
                    <feComposite operator="out" in="SourceGraphic" in2="blur-2" />
                    <feComposite operator="in" in="color" />
                    <feComposite operator="in" in2="SourceGraphic" />
                </filter>
            </defs>
            <g id="Group_4185" data-name="Group 4185" transform="translate(9 6)">
                <g data-type="innerShadowGroup">
                    <g transform="matrix(1, 0, 0, 1, -9, -6)" filter="url(#Ellipse_16)">
                        <g id="Ellipse_16-3" data-name="Ellipse 16" transform="translate(9 6)" fill="#fefbd7"
                            stroke="#ececec" stroke-width="1">
                            <circle cx="34.275" cy="34.275" r="34.275" stroke="none" />
                            <circle cx="34.275" cy="34.275" r="33.775" fill="none" />
                        </g>
                    </g>
                    <circle id="Ellipse_16-4" data-name="Ellipse 16" cx="34.275" cy="34.275" r="34.275"
                        transform="translate(0)" fill="#fefbd7" />
                    <g transform="matrix(1, 0, 0, 1, -9, -6)" filter="url(#Ellipse_16-2)">
                        <circle id="Ellipse_16-5" data-name="Ellipse 16" cx="34.275" cy="34.275" r="34.275"
                            transform="translate(9 6)" fill="#fff" />
                    </g>
                    <g id="Ellipse_16-6" data-name="Ellipse 16" transform="translate(0)" fill="none" stroke="#ececec"
                        stroke-width="1">
                        <circle cx="34.275" cy="34.275" r="34.275" stroke="none" />
                        <circle cx="34.275" cy="34.275" r="33.775" fill="none" />
                    </g>
                </g>
                <path id="arrow_back_ios_24dp_000000_FILL0_wght400_GRAD0_opsz24"
                    d="M17,33.99,0,17,17,0l3.017,3.017L6.033,17,20.012,30.974Z"
                    transform="translate(52.029 22.465) rotate(90)" fill="gray" />
            </g>
        </svg>
    </div>

    <div class="social_feed_details2" id="socialFeedDetails_{{ job_search.id }}" style="display:none;">

        {% if job_search.activities.all %}
            {% for activity in job_search.activities.all %}
            <div class="job_feed_application" id="job_feed_application_{{ activity.id }}">
                <span class="job_feed_ca_icon_action" id="job_feed_ca_icon_action_{{ activity.id }}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="42.88" height="35.1" viewBox="0 0 60.937 48.75">
                        <path id="label_important_24dp_000000_FILL0_wght400_GRAD0_opsz24"
                            d="M80-751.25l18.281-24.375L80-800h39.609a6.048,6.048,0,0,1,2.742.648,5.841,5.841,0,0,1,2.133,1.79l16.453,21.937-16.453,21.937a5.843,5.843,0,0,1-2.133,1.79,6.05,6.05,0,0,1-2.742.648Zm12.187-6.094h27.422l13.711-18.281-13.711-18.281H92.187L105.9-775.625ZM112.754-775.625Z"
                            transform="translate(-80 800)" fill="#eca2f5" />
                    </svg>
                </span>
                <span class="job_feed_ca_company_name" id="job_feed_ca_company_name_{{ activity.id }}">{{ activity.company.company_name }}</span>
                <span class="job_feed_ca_job_link" id="job_feed_ca_job_link_{{ activity.id }}">
                    <a href="{{ activity.link_to_vacancy }}" target="_blank">
                        <svg xmlns="http://www.w3.org/2000/svg" width="33.106" height="16.553" viewBox="0 0 33.106 16.553">
                            <path id="link_24dp_000000_FILL0_wght400_GRAD0_opsz24_job_feed"
                                d="M94.9-663.447H88.276a7.977,7.977,0,0,1-5.856-2.421A7.976,7.976,0,0,1,80-671.724a7.977,7.977,0,0,1,2.421-5.856A7.976,7.976,0,0,1,88.276-680H94.9v3.31H88.276a4.788,4.788,0,0,0-3.517,1.448,4.789,4.789,0,0,0-1.448,3.517,4.789,4.789,0,0,0,1.448,3.517,4.789,4.789,0,0,0,3.517,1.448H94.9Zm-4.966-6.621v-3.31h13.242v3.31Zm8.276,6.621v-3.311h6.621a4.789,4.789,0,0,0,3.517-1.448,4.789,4.789,0,0,0,1.448-3.517,4.789,4.789,0,0,0-1.448-3.517,4.788,4.788,0,0,0-3.517-1.448H98.208V-680h6.621a7.976,7.976,0,0,1,5.856,2.421,7.977,7.977,0,0,1,2.421,5.856,7.977,7.977,0,0,1-2.421,5.856,7.977,7.977,0,0,1-5.856,2.421Z"
                                transform="translate(-80 680)" fill="#cecece" />
                        </svg>
                    </a>
                </span>
                <span class="job_feed_ca_job_cv" id="job_feed_ca_job_cv_{{ activity.id }}">
                    {% if activity.cv_file %}
                    <a href="{{ activity.cv_file.url }}" target="_blank">
                        <svg xmlns="http://www.w3.org/2000/svg" width="31.515" height="27.515" viewBox="0 0 31.515 27.515">
                            <path id="deployed_code_account_24dp_000000_FILL0_wght400_GRAD0_opsz24"
                                d="M104.242-772.485a2.656,2.656,0,0,1-.646-.081,1.776,1.776,0,0,1-.606-.283l-4.848-2.828a2.243,2.243,0,0,1-.869-.869,2.413,2.413,0,0,1-.3-1.192v-5.7a2.414,2.414,0,0,1,.3-1.192,2.244,2.244,0,0,1,.869-.869l4.848-2.828a1.779,1.779,0,0,1,.606-.283,2.655,2.655,0,0,1,.646-.081,1.966,1.966,0,0,1,.626.1,3.25,3.25,0,0,1,.586.263L110.3-785.5a2.394,2.394,0,0,1,.889.869,2.3,2.3,0,0,1,.323,1.192v5.7a2.3,2.3,0,0,1-.323,1.192,2.392,2.392,0,0,1-.889.869l-4.848,2.828a3.254,3.254,0,0,1-.586.263A1.968,1.968,0,0,1,104.242-772.485ZM92.929-787.071a6.225,6.225,0,0,1-4.566-1.9,6.225,6.225,0,0,1-1.9-4.566,6.225,6.225,0,0,1,1.9-4.566,6.225,6.225,0,0,1,4.566-1.9,6.225,6.225,0,0,1,4.566,1.9,6.225,6.225,0,0,1,1.9,4.566,6.225,6.225,0,0,1-1.9,4.566A6.225,6.225,0,0,1,92.929-787.071ZM80-774.142v-4.525a4.872,4.872,0,0,1,.687-2.505,4.48,4.48,0,0,1,1.9-1.778,25.308,25.308,0,0,1,4.646-1.778,21,21,0,0,1,5.7-.727h.566a1.523,1.523,0,0,1,.485.081,11.227,11.227,0,0,0-.545,1.515,12.571,12.571,0,0,0-.343,1.636h-.162a16.94,16.94,0,0,0-5.151.727,26.56,26.56,0,0,0-3.737,1.455,1.572,1.572,0,0,0-.586.566,1.519,1.519,0,0,0-.222.808v1.293H93.414a10.237,10.237,0,0,0,.646,1.677,13.365,13.365,0,0,0,.889,1.556ZM92.929-790.3a3.112,3.112,0,0,0,2.283-.949,3.113,3.113,0,0,0,.949-2.283,3.112,3.112,0,0,0-.949-2.283,3.112,3.112,0,0,0-2.283-.95,3.112,3.112,0,0,0-2.283.95,3.112,3.112,0,0,0-.949,2.283,3.113,3.113,0,0,0,.949,2.283A3.112,3.112,0,0,0,92.929-790.3ZM92.929-793.536ZM93.414-777.374Zm7.03-6.707,3.8,2.222,3.8-2.222-3.8-2.182Zm5.01,8.4,3.636-2.1v-4.444l-3.636,2.141Zm-6.061-2.1,3.636,2.141v-4.4l-3.636-2.141Z"
                                transform="translate(-80 800)" />
                        </svg>
                    </a>
                    {% else %}
                    <svg xmlns="http://www.w3.org/2000/svg" width="31.515" height="27.515" viewBox="0 0 31.515 27.515">
                        <path id="deployed_code_account_24dp_000000_FILL0_wght400_GRAD0_opsz24"
                            d="M104.242-772.485a2.656,2.656,0,0,1-.646-.081,1.776,1.776,0,0,1-.606-.283l-4.848-2.828a2.243,2.243,0,0,1-.869-.869,2.413,2.413,0,0,1-.3-1.192v-5.7a2.414,2.414,0,0,1,.3-1.192,2.244,2.244,0,0,1,.869-.869l4.848-2.828a1.779,1.779,0,0,1,.606-.283,2.655,2.655,0,0,1,.646-.081,1.966,1.966,0,0,1,.626.1,3.25,3.25,0,0,1,.586.263L110.3-785.5a2.394,2.394,0,0,1,.889.869,2.3,2.3,0,0,1,.323,1.192v5.7a2.3,2.3,0,0,1-.323,1.192,2.392,2.392,0,0,1-.889.869l-4.848,2.828a3.254,3.254,0,0,1-.586.263A1.968,1.968,0,0,1,104.242-772.485ZM92.929-787.071a6.225,6.225,0,0,1-4.566-1.9,6.225,6.225,0,0,1-1.9-4.566,6.225,6.225,0,0,1,1.9-4.566,6.225,6.225,0,0,1,4.566-1.9,6.225,6.225,0,0,1,4.566,1.9,6.225,6.225,0,0,1,1.9,4.566,6.225,6.225,0,0,1-1.9,4.566A6.225,6.225,0,0,1,92.929-787.071ZM80-774.142v-4.525a4.872,4.872,0,0,1,.687-2.505,4.48,4.48,0,0,1,1.9-1.778,25.308,25.308,0,0,1,4.646-1.778,21,21,0,0,1,5.7-.727h.566a1.523,1.523,0,0,1,.485.081,11.227,11.227,0,0,0-.545,1.515,12.571,12.571,0,0,0-.343,1.636h-.162a16.94,16.94,0,0,0-5.151.727,26.56,26.56,0,0,0-3.737,1.455,1.572,1.572,0,0,0-.586.566,1.519,1.519,0,0,0-.222.808v1.293H93.414a10.237,10.237,0,0,0,.646,1.677,13.365,13.365,0,0,0,.889,1.556ZM92.929-790.3a3.112,3.112,0,0,0,2.283-.949,3.113,3.113,0,0,0,.949-2.283,3.112,3.112,0,0,0-.949-2.283,3.112,3.112,0,0,0-2.283-.95,3.112,3.112,0,0,0-2.283.95,3.112,3.112,0,0,0-.949,2.283,3.113,3.113,0,0,0,.949,2.283A3.112,3.112,0,0,0,92.929-790.3ZM92.929-793.536ZM93.414-777.374Zm7.03-6.707,3.8,2.222,3.8-2.222-3.8-2.182Zm5.01,8.4,3.636-2.1v-4.444l-3.636,2.141Zm-6.061-2.1,3.636,2.141v-4.4l-3.636-2.141Z"
                            transform="translate(-80 800)" />
                    </svg>
                    {% endif %}
                </span>
                <span class="job_feed_ca_status" id="job_feed_ca_status_{{ activity.id }}">{{ activity.get_status_display|default:activity.status }}</span>
                <span class="job_feed_ca_expand_icon" id="job_feed_ca_expand_icon_{{ activity.id }}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18.842" height="11.093" viewBox="0 0 18.842 11.093">
                        <path id="arrow_back_ios_24dp_000000_FILL0_wght400_GRAD0_opsz24"
                            d="M9.421,18.842,0,9.421,9.421,0l1.672,1.672L3.344,9.421l7.749,7.749Z"
                            transform="translate(0 11.093) rotate(-90)" />
                    </svg>
                </span>
            </div>
            <div class="job_feed_actions_details collapsed" id="job_feed_actions_details_{{ activity.id }}">
                <div class="job_feed_action_details" id="job_feed_action_details_{{ activity.id }}_1">
                    <span class="job_feed_action_details_icon_done" id="job_feed_action_details_icon_done_{{ activity.id }}_1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 33.425 33.425">
                            <path id="check_circle_24dp_000000_FILL0_wght400_GRAD0_opsz24_1"
                                d="M94.373-855.6l11.782-11.783-2.34-2.34-9.443,9.443-4.763-4.763-2.34,2.34Zm2.34,9.025a16.277,16.277,0,0,1-6.518-1.316,16.883,16.883,0,0,1-5.306-3.572,16.874,16.874,0,0,1-3.572-5.306A16.274,16.274,0,0,1,80-863.287a16.274,16.274,0,0,1,1.316-6.518,16.876,16.876,0,0,1,3.572-5.306,16.876,16.876,0,0,1,5.306-3.572A16.279,16.279,0,0,1,96.713-880a16.279,16.279,0,0,1,6.518,1.316,16.876,16.876,0,0,1,5.306,3.572,16.876,16.876,0,0,1,3.572,5.306,16.274,16.274,0,0,1,1.316,6.518,16.274,16.274,0,0,1-1.316,6.518,16.874,16.874,0,0,1-3.572,5.306,16.882,16.882,0,0,1-5.306,3.572A16.277,16.277,0,0,1,96.713-846.575Zm0-3.343A12.9,12.9,0,0,0,106.2-853.8a12.9,12.9,0,0,0,3.886-9.484,12.9,12.9,0,0,0-3.886-9.484,12.9,12.9,0,0,0-9.484-3.886,12.9,12.9,0,0,0-9.484,3.886,12.9,12.9,0,0,0-3.886,9.484,12.9,12.9,0,0,0,3.886,9.484A12.9,12.9,0,0,0,96.713-849.917ZM96.713-863.287Z"
                                transform="translate(-80 880)" fill="#00e608" />
                        </svg>
                    </span>
                    <span class="job_feed_action_details_text" id="job_feed_action_details_text_{{ activity.id }}_1">
                        {% if activity.tasks.all %}
                            {% with first_task=activity.tasks.first %}
                                {{ first_task.title }}
                            {% endwith %}
                        {% else %}
                            Send resume
                        {% endif %}
                    </span>
                    <span class="job_feed_action_datetime_container" id="job_feed_action_datetime_container_{{ activity.id }}_1">
                        <span class="job_feed_action_details_date" id="job_feed_action_details_date_{{ activity.id }}_1">
                            {% if activity.tasks.all %}
                                {% with first_task=activity.tasks.first %}
                                    {{ first_task.updated_at|date:'d.m.Y' }}
                                {% endwith %}
                            {% else %}
                                {% if activity.start_date %}
                                    {{ activity.start_date|date:'d.m.Y' }}
                                {% else %}
                                    {{ activity.last_update|date:'d.m.Y' }}
                                {% endif %}
                            {% endif %}
                        </span>
                    </span>
                    <span class="job_feed_action_icon_help" id="job_feed_action_icon_help_{{ activity.id }}_1">
                        üí°
                    </span>
                </div>
                <div class="job_feed_action_details" id="job_feed_action_details_{{ activity.id }}_2">
                    <span class="job_feed_action_details_icon_done" id="job_feed_action_details_icon_done_{{ activity.id }}_2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 33.425 33.425">
                            <path id="check_circle_24dp_000000_FILL0_wght400_GRAD0_opsz24_2"
                                d="M94.373-855.6l11.782-11.783-2.34-2.34-9.443,9.443-4.763-4.763-2.34,2.34Zm2.34,9.025a16.277,16.277,0,0,1-6.518-1.316,16.883,16.883,0,0,1-5.306-3.572,16.874,16.874,0,0,1-3.572-5.306A16.274,16.274,0,0,1,80-863.287a16.274,16.274,0,0,1,1.316-6.518,16.876,16.876,0,0,1,3.572-5.306,16.876,16.876,0,0,1,5.306-3.572A16.279,16.279,0,0,1,96.713-880a16.279,16.279,0,0,1,6.518,1.316,16.876,16.876,0,0,1,5.306,3.572,16.876,16.876,0,0,1,3.572,5.306,16.274,16.274,0,0,1,1.316,6.518,16.274,16.274,0,0,1-1.316,6.518,16.874,16.874,0,0,1-3.572,5.306,16.882,16.882,0,0,1-5.306,3.572A16.277,16.277,0,0,1,96.713-846.575Zm0-3.343A12.9,12.9,0,0,0,106.2-853.8a12.9,12.9,0,0,0,3.886-9.484,12.9,12.9,0,0,0-3.886-9.484,12.9,12.9,0,0,0-9.484-3.886,12.9,12.9,0,0,0-9.484,3.886,12.9,12.9,0,0,0-3.886,9.484,12.9,12.9,0,0,0,3.886,9.484A12.9,12.9,0,0,0,96.713-849.917ZM96.713-863.287Z"
                                transform="translate(-80 880)" fill="#e8e8e8" />
                        </svg>
                    </span>
                    <span class="job_feed_action_details_text" id="job_feed_action_details_text_{{ activity.id }}_2">
                        {% if activity.tasks.all|length > 1 %}
                            {% with second_task=activity.tasks.all|slice:"1:2"|first %}
                                {{ second_task.title }}
                            {% endwith %}
                        {% else %}
                            Technical interview
                        {% endif %}
                    </span>
                    <span class="job_feed_action_datetime_container" id="job_feed_action_datetime_container_{{ activity.id }}_2">
                        <span class="job_feed_action_icon_time" id="job_feed_action_time_{{ activity.id }}_2">9:00 - 11:00</span>
                        <span class="job_feed_action_details_date" id="job_feed_action_details_date_{{ activity.id }}_2">
                            {% if activity.tasks.all|length > 1 %}
                                {% with second_task=activity.tasks.all|slice:"1:2"|first %}
                                    {{ second_task.updated_at|date:'d.m.Y' }}
                                {% endwith %}
                            {% else %}
                                {% if activity.start_date %}
                                    {{ activity.start_date|date:'d.m.Y' }}
                                {% else %}
                                    {{ activity.last_update|date:'d.m.Y' }}
                                {% endif %}
                            {% endif %}
                        </span>
                    </span>
                    <span class="job_feed_action_icon_help" id="job_feed_action_icon_help_{{ activity.id }}_2">
                        üí°
                    </span>
                </div>
                <button class="job_feed_next_action" id="job_feed_next_action_{{ activity.id }}" data-activity-id="{{ activity.id }}">next</button>
            </div>
            {% endfor %}
        {% else %}
            <div class="job_feed_no_activities">
                <p>No activities yet. Click the + button to add your first job search activity.</p>
            </div>
        {% endif %}

    </div>
</div>

<!-- –ü–æ–ø–∞–ø –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
<div id="add-activity-form-{{ job_search.id }}" class="modal-overlay">
    <div class="modal-form">
        <button class="modal_close_btn">
            <svg width="24" height="24" viewBox="0 0 24 24">
                <path
                    d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
            </svg>
        </button>

        <form class="project-form" id="add-activity-form-{{ job_search.id }}" method="post"
            enctype="multipart/form-data"
            action="{% url 'services_and_projects:add_job_search_activity' job_search.id %}">
            {% csrf_token %}

            <div class="form-group">
                <label for="activity-company-{{ job_search.id }}">Company</label>
                <!-- DEBUG: all_companies = {{ all_companies|safe }} -->
                <div id="activity-company-container-{{ job_search.id }}" class="form-control company-chip-container"
                    tabindex="0" data-all-companies='{{ all_companies|safe }}'>
                    <input type="text" id="activity-company-input-{{ job_search.id }}"
                        placeholder="Start typing company name..." autocomplete="off" class="company-input-field">
                </div>
                <div id="activity-company-dropdown-{{ job_search.id }}" class="company-dropdown-menu"></div>
                <input type="hidden" name="company_name" id="activity-company-hidden-{{ job_search.id }}">
            </div>

            <div class="form-group">
                <label for="activity-vacancy-link-{{ job_search.id }}">Vacancy Link</label>
                <input type="url" id="activity-vacancy-link-{{ job_search.id }}" name="link_to_vacancy"
                    placeholder="https://example.com/vacancy" required>
            </div>

            <div class="form-group">
                <label for="activity-cv-file-{{ job_search.id }}">CV File</label>
                <div class="file-upload-area">
                    <input type="file" id="activity-cv-file-{{ job_search.id }}" name="cv_file"
                        accept=".pdf,.doc,.docx">
                    <div class="drop-zone">
                        <p>Drop CV file here or click to upload</p>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-secondary save-btn">Save Activity</button>
            </div>
        </form>
    </div>
</div>

<!-- –ü–æ–ø–∞–ø –¥–ª—è –±–ª–æ–∫–Ω–æ—Ç–∞ -->
<div id="note_button_007_notesPopup_{{ job_search.id }}" class="notes-popup-overlay notes-popup">
    <div class="notes-popup-content">
        <div class="notes-popup-header">
            <h3 class="notes-popup-title">Notes for Job Search #{{ job_search.id }}</h3>
            <button class="notes-popup-close notes-close-btn">&times;</button>
        </div>
        <div class="notes-popup-body">
            <form id="note_button_007_notesForm_{{ job_search.id }}" method="POST"
                action="{% url 'services_and_projects:save_job_search_notes' job_search.id %}" class="notes-form">
                {% csrf_token %}
                <div class="form-group">
                    <label for="job_search_notes_{{ job_search.id }}">Notes:</label>
                    <textarea id="note_button_007_job_search_notes_{{ job_search.id }}" name="notes"
                        class="form-control notes-textarea">{{ job_search.notes|default:'' }}</textarea>
                </div>
                <div class="notes-popup-actions">
                    <button type="submit" class="btn btn-primary notes-save-btn">Save</button>
                    <button type="button" class="btn btn-secondary notes-cancel-btn">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- –ü–æ–ø–∞–ø –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞—Å–∫–∏ -->
<div id="create-task-modal-{{ job_search.id }}" class="modal-overlay">
    <div class="modal-form">
        <button class="modal_close_btn" onclick="closeCreateTaskModal({{ job_search.id }})">
            <svg width="24" height="24" viewBox="0 0 24 24">
                <path
                    d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
            </svg>
        </button>

        <form class="project-form task-creation-form" id="create-task-form-{{ job_search.id }}" method="post" action="" data-form-type="task-creation">
            {% csrf_token %}
            <input type="hidden" name="activity_id" id="task-activity-id-{{ job_search.id }}">

            <div class="form-group">
                <label for="task-title-{{ job_search.id }}">Task Title</label>
                <input type="text" id="task-title-{{ job_search.id }}" name="title" placeholder="Enter task title" required>
            </div>

            <div class="form-group">
                <label for="task-description-{{ job_search.id }}">Task Description</label>
                <textarea id="task-description-{{ job_search.id }}" name="description" rows="4" placeholder="Enter task description"></textarea>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-secondary save-btn">Save Task</button>
            </div>
        </form>
    </div>
</div>

<!-- –ü–æ–ø–∞–ø –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ -->
{% include 'services_and_projects/publish_form.html' with post_type='job_search' post_id=job_search.id %}
            


<!-- JavaScript –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ø–∞–ø–æ–º —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞—Å–∫–∏ -->
<script>
function openCreateTaskModal(activityId) {
    console.log('=== OPENING TASK MODAL ===');
    console.log('Activity ID:', activityId);
    
    const jobSearchId = {{ job_search.id }};
    console.log('Job Search ID:', jobSearchId);
    
    const modal = document.getElementById(`create-task-modal-${jobSearchId}`);
    console.log('Modal element:', modal);
    
    const activityIdInput = document.getElementById(`task-activity-id-${jobSearchId}`);
    console.log('Activity ID input:', activityIdInput);
    
    if (!modal) {
        console.error('Modal not found!');
        alert('Modal not found. Please refresh the page.');
        return;
    }
    
    if (!activityIdInput) {
        console.error('Activity ID input not found!');
        alert('Activity ID input not found. Please refresh the page.');
        return;
    }
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º ID –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ
    activityIdInput.value = activityId;
    console.log('Activity ID set to input:', activityId);
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π action –¥–ª—è —Ñ–æ—Ä–º—ã
    const form = modal.querySelector('form');
    if (form) {
        form.action = `/services_and_projects/create_activity_task/${activityId}/`;
        console.log('Form action set to:', form.action);
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø
    modal.style.display = 'flex';
    console.log('Modal displayed');
    console.log('=== MODAL OPENED ===');
}

function closeCreateTaskModal(jobSearchId) {
    const modal = document.getElementById(`create-task-modal-${jobSearchId}`);
    modal.style.display = 'none';
    
    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
    const form = document.getElementById(`create-task-form-${jobSearchId}`);
    form.reset();
}



// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞—Å–∫–∏
document.addEventListener('DOMContentLoaded', function() {
    const jobSearchId = {{ job_search.id }};
    
    // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫ –∫–Ω–æ–ø–∫–∞–º "next"
    const nextButtons = document.querySelectorAll('.job_feed_next_action');
    
    nextButtons.forEach(button => {
        const activityId = button.getAttribute('data-activity-id');
        
        button.addEventListener('click', function(e) {
            e.preventDefault();
            openCreateTaskModal(parseInt(activityId));
        });
    });
    

    
    const form = document.getElementById(`create-task-form-${jobSearchId}`);
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ñ–æ—Ä–º–∞ –Ω–∞–π–¥–µ–Ω–∞
    if (!form) {
        console.error(`Form create-task-form-${jobSearchId} not found!`);
        return;
    }
    
    // –°–æ–∑–¥–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
    window.handleTaskFormSubmit = function(formElement, event) {
        event.preventDefault();
        
        const formData = new FormData(formElement);
        const activityId = formData.get('activity_id');
        
        // –ü–æ–ª—É—á–∞–µ–º CSRF —Ç–æ–∫–µ–Ω –∏–∑ cookie
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        
        const csrftoken = getCookie('csrftoken');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º CSRF —Ç–æ–∫–µ–Ω
        if (!csrftoken) {
            const errorMsg = 'CSRF token not found. Please refresh the page and try again.';
            console.error(errorMsg);
            if (typeof window.alertify !== 'undefined') {
                window.alertify.error(errorMsg);
            } else {
                alert(errorMsg);
            }
            return false; // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É
        }
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º AJAX –∑–∞–ø—Ä–æ—Å
        fetch(`/services_and_projects/create_activity_task/${activityId}/`, {
            method: 'POST',
            body: formData,
            headers: {
                'X-CSRFToken': csrftoken
            }
        })
        .then(response => {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ—Ç–≤–µ—Ç –Ω–µ HTML
            const contentType = response.headers.get('content-type');
            
            if (contentType && contentType.includes('application/json')) {
                return response.json();
            } else {
                            // –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª HTML, —á–∏—Ç–∞–µ–º –µ–≥–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
            return response.text().then(text => {
                throw new Error('Server returned HTML instead of JSON. Check server logs for errors.');
            });
            }
        })
        .then(data => {
            
            if (data.success) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞—Å–∫–∏
                updateTaskDisplay(activityId, data);
                
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ–ø–∞–ø
                closeCreateTaskModal(jobSearchId);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
                if (typeof window.alertify !== 'undefined') {
                    window.alertify.success('Task created successfully!');
                } else {
                    alert('Task created successfully!');
                }
            } else {
                if (typeof window.alertify !== 'undefined') {
                    window.alertify.error('Error creating task: ' + data.error);
                } else {
                    alert('Error creating task: ' + data.error);
                }
            }
        })
        .catch(error => {
            console.error('Error:', error);
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º alertify –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω, –∏–Ω–∞—á–µ –æ–±—ã—á–Ω—ã–π alert
            if (typeof window.alertify !== 'undefined') {
                window.alertify.error('Error creating task: ' + error.message);
            } else {
                alert('Error creating task: ' + error.message);
            }
        });
        
        return false; // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É
    };
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞ —Ñ–æ—Ä–º—É
    form.addEventListener('submit', function(e) {
        return window.handleTaskFormSubmit(this, e);
    });
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å form_for_all_task.js
    // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º –≤—Å–µ —Ñ–æ—Ä–º—ã —Å –∫–ª–∞—Å—Å–æ–º task-creation-form
    document.addEventListener('submit', function(e) {
        if (e.target.classList.contains('task-creation-form')) {
            e.preventDefault();
            e.stopPropagation();
            return window.handleTaskFormSubmit(e.target, e);
        }
    }, true); // –ò—Å–ø–æ–ª—å–∑—É–µ–º capture phase –¥–ª—è —Ä–∞–Ω–Ω–µ–≥–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞
});

function updateTaskDisplay(activityId, taskData) {
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç —Ç–∞—Å–∫–∏
    const firstTaskText = document.getElementById(`job_feed_action_details_text_${activityId}_1`);
    const firstTaskDate = document.getElementById(`job_feed_action_details_date_${activityId}_1`);
    
    if (firstTaskText && firstTaskDate) {
        firstTaskText.textContent = taskData.task_title;
        firstTaskDate.textContent = taskData.task_updated_at;
    }
    
    // –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤–∞—è —Ç–∞—Å–∫–∞, –æ–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É –Ω–∞ –∑–µ–ª–µ–Ω—É—é
    const firstTaskIcon = document.getElementById(`job_feed_action_details_icon_done_${activityId}_1`);
    if (firstTaskIcon) {
        const svg = firstTaskIcon.querySelector('svg path');
        if (svg) {
            svg.setAttribute('fill', '#00e608');
        }
    }
}
</script>

{% endif %}

<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º CSS –¥–ª—è Job Search Feed -->
<link rel="stylesheet" href="{% static 'css/job_search_feed.css' %}">

<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å–∫—Ä–∏–ø—Ç –¥–ª—è Job Search Feed -->
<script src="{% static 'js/job_search_feed.js' %}"></script>