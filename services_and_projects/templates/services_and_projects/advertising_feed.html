{% load static %}

<!-- Подключаем CSS для Advertising Feed -->
<link rel="stylesheet" href="{% static 'css/advertising_feed.css' %}">

<div class="social_feed" data-post-id="{{ advertising.id }}" data-post-type="advertising">
    <div class="social_feed_user_name">
        <div class="social_feed_user_name_image">
            {% if owner and owner.avatar %}
                <img src="{{ owner.avatar.url }}" alt="User Avatar" style="width: 60px; height: 60px; border-radius: 50%; object-fit: cover;">
            {% else %}
                <div style="width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; font-size: 32px;">
                    {{ owner.get_default_avatar_emoji|default:"👤" }}
                </div>
            {% endif %}
            <div class="social_feed_user_text_name">
                {% if owner %}
                    {{ owner.get_full_name|default:owner.username }}
                {% else %}
                    Anonymous User
                {% endif %}
            </div>
        </div>
        <div class="advertising_social_feed_menu">
            <button class="advertising_social_feed_menu_trigger" id="menu_trigger_{{ advertising.id }}" type="button">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
                </svg>
            </button>
            <div class="advertising_social_feed_overflow_menu" id="overflow_menu_{{ advertising.id }}">
                <div class="advertising_social_feed_overflow_menu_item edit" data-action="edit" data-id="{{ advertising.id }}">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                    </svg>
                    Edit
                </div>
                <div class="advertising_social_feed_overflow_menu_item remove" data-action="remove" data-id="{{ advertising.id }}">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                    Remove
                </div>
                <div class="advertising_social_feed_overflow_menu_item share" data-action="share" data-id="{{ advertising.id }}">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"/>
                    </svg>
                    Share
                </div>
            </div>
        </div>
    </div>
    <div class="post_info">
        <span class="post_id">{{ advertising.id }}</span>
        <span class="post_date">{{ advertising.creation_date|date:'d.m.Y' }}</span>
    </div>
    <div class="social_feed_text">
        {% if advertising.description|length > 238 %}
            <p data-full-text="{{ advertising.description }}">{{ advertising.description|slice:":238" }}...</p>
            <div class="read_more">Read more...</div>
        {% else %}
            <p>{{ advertising.description }}</p>
        {% endif %}
    </div>
    <div class="social_feed_image_gallery_1">
        {% for photo in advertising.photos.all %}
            <a href="{{ photo.photo.url }}" 
               data-pswp-width="{{ photo.photo.width|default:1200 }}" 
               data-pswp-height="{{ photo.photo.height|default:800 }}"
               data-pswp-src="{{ photo.photo.url }}">
                <img src="{{ photo.photo.url }}" 
                     alt="Image {{ forloop.counter }}"
                     loading="lazy"
                     style="object-fit: cover; width: 100%; height: 100%;">
            </a>
        {% endfor %}
    </div>
    <div class="social_feed_tags">
        <span>
            {% for tag in advertising.hashtags.all %}
                {{ tag.tag }}{% if not forloop.last %}, {% endif %}
            {% endfor %}
        </span>
    </div>
    <div class="post_actions">
        <div class="action_buttons">
            <button class="action_btn">Chat</button>
            <button class="action_btn">Comments</button>
        </div>
        <button class="order_now">Order now</button>
    </div>
</div>

<!-- Подключаем скрипт для Advertising Feed -->
<script src="{% static 'js/advertising_feed.js' %}"></script> 