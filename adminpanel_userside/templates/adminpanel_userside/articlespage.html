{% extends "adminpanel_userside/base.html" %}
{% load static %}

{% block extra_styles %}
<link rel="stylesheet" href="{% static 'adminpanel_userside/vendor/bootstrap-select/bootstrap-select.css' %}">
<link rel="stylesheet" href="{% static 'adminpanel_userside/css/apps/documents.css' %}"> 
<link rel="stylesheet" href="{% static 'adminpanel_userside/vendor/webui-popover/webui-popover.css' %}"> 
<link rel="stylesheet" href="{% static 'adminpanel_userside/css/uikit/tooltip-popover.css' %}"> 
<link rel="stylesheet" href="{% static 'adminpanel_userside/vendor/toolbar/toolbar.css' %}">   
{% endblock %}


{% block content %}
<div class="page animsition">
  <!-- Заголовок страницы с названием выбранной категории -->
  <div class="page-header">
    <h1 class="page-title">
      Articles{% if selected_category %} - {{ selected_category.name }}{% endif %}
    </h1>
    
    <!-- Выпадающий список категорий -->
    <div class="page-header-actions" style="z-index: 200;">
      <div class="btn-group btn-group-sm" id="withBtnGroup" aria-label="Page Header Actions" role="group">
        <div class="dropdown" style="position: relative; z-index: 200;">
          <button type="button" class="btn btn-primary dropdown-toggle waves-effect waves-light waves-round" data-toggle="dropdown" aria-expanded="false">
            Categories
            <span class="icon md-chevron-down" aria-hidden="true"></span>
          </button>
          <ul class="dropdown-menu dropdown-menu-right" role="menu" style="position: absolute; z-index: 10001 !important;">
            {% for category in categories %}
              <li data-type="fade">
                <a href="{% url 'adminpanel_userside:articles_page' %}?category={{ category.id }}">{{ category.name }}</a>
              </li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Контент страницы: список статей -->
  <div class="page-content">
    {% if articles %}
      <ul class="blocks blocks-100 blocks-xlg-4 blocks-md-3 blocks-sm-2" data-plugin="masonry">
        {% for article in articles %}
          <li class="masonry-item">
            <div class="widget widget-article widget-shadow">
              <div class="widget-header cover">
                {% if article.title_image %}
                  <img class="cover-image" src="{{ article.title_image.url }}" alt="{{ article.theme }}">
                {% else %}
                  <img class="cover-image" src="{% static 'adminpanel_userside/images/pattern4.png' %}" alt="Default">
                {% endif %}
              </div>
              <div class="widget-body">
                <h3 class="widget-title">{{ article.theme|truncatechars:21 }}</h3>
                <p class="widget-metas type-link">
                  By <a href="#">{{ article.creator }}</a>
                  <a href="#">{{ article.published_date|date:"d M, Y" }}</a>
                  <a href="#">
                    <span>3</span> Comments
                  </a>
                </p>
                <p>{{ article.article_text|truncatechars:83 }}</p>
                <div class="widget-body-footer">
                  <div class="widget-actions pull-right">
                    <a href="#">
                      <i class="icon md-favorite" aria-hidden="true"></i>
                      <span>108</span>
                    </a>
                  </div>
                  <!-- Кнопка Edit с переходом на страницу редактирования статьи -->
                  <a href="{% url 'adminpanel_userside:edit_article' article.id %}" class="btn btn-info">Edit</a>
                </div>
              </div>
            </div>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No articles found in this category.</p>
    {% endif %}
  </div>

  <!-- Пагинация (при необходимости) -->
  <div class="text-center">
    <nav>
      <ul class="pagination pagination-no-border">
        <li class="disabled">
          <a href="javascript:void(0)" aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
        <li class="active"><a href="javascript:void(0)">1 <span class="sr-only">(current)</span></a></li>
        <li><a href="javascript:void(0)">2</a></li>
        <li>
          <a href="javascript:void(0)" aria-label="Next">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
      </ul>
    </nav>
  </div>
</div>

<!-- Кнопка для создания новой статьи -->
<div class="popover_button" style="position: fixed; bottom: 40px; right: 30px; z-index: 9999;">
  <div class="toolbar-icons hidden" id="set-03-options">
    <a href="{% url 'adminpanel_userside:create_article' %}">
      <i class="icon md-assignment" aria-hidden="true"></i>
    </a>
  </div>
  <button class="btn btn-warning btn-icon btn-round" data-plugin="toolbar" data-toolbar="#set-03-options"
    data-toolbar-style="warning" data-toolbar-position="left" type="button">
    <i class="icon md-plus-circle" aria-hidden="true"></i>
  </button>
</div>


{% endblock %}

{% block extrajs_styles %}

<script src="{% static 'adminpanel_userside/js/apps/documents.js' %}"></script>

{% comment %} Кнопка внизу справа {% endcomment %}
<script src="{% static 'adminpanel_userside/js/components/toolbar_open.js' %}"></script>
<script src="{% static 'adminpanel_userside/vendor/toolbar/jquery.toolbar.js' %}"></script>
<script src="{% static 'adminpanel_userside/js/components/toolbar.js' %}"></script>

{% endblock %}

